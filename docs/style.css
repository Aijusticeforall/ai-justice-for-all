document.addEventListener("DOMContentLoaded", () => {
  const glowButton = document.getElementById("glow-button");
  const landing = document.querySelector(".landing");
  const chatPopup = document.getElementById("chat-popup");

  if (glowButton) {
    glowButton.addEventListener("click", () => {
      landing.classList.add("hidden");
      chatPopup.classList.remove("hidden");
    });
  }

  const toggleSidebar = document.getElementById("toggle-sidebar");
  const sidebar = document.getElementById("chat-sidebar");
  const newChatBtn = document.querySelector(".new-chat-btn");
  const sendButton = document.getElementById("send-button");
  const chatInput = document.getElementById("chat-input");
  const chatWindow = document.getElementById("chat-window");

  // Toggle sidebar
  toggleSidebar.addEventListener("click", () => {
    sidebar.classList.toggle("collapsed");
    sidebar.classList.toggle("expanded");
  });

  // Theme toggle
  document.getElementById("toggle-theme").addEventListener("click", () => {
    document.body.classList.toggle("light");
    document.body.classList.toggle("dark");
  });

  // New chat
  newChatBtn.addEventListener("click", () => {
    const msg = document.createElement("div");
    msg.textContent = "New Chat Started";
    chatWindow.appendChild(msg);
  });

  function sendMessage() {
    const text = chatInput.value.trim();
    if (!text) return;
    const userMsg = document.createElement("div");
    userMsg.className = "user";
    userMsg.textContent = text;
    chatWindow.appendChild(userMsg);
    chatInput.value = "";

    const aiReply = document.createElement("div");
    aiReply.className = "ai";
    aiReply.textContent = "This is a simulated reply.";
    chatWindow.appendChild(aiReply);
  }

  sendButton.addEventListener("click", sendMessage);
  chatInput.addEventListener("keydown", e => {
    if (e.key === "Enter" && !e.shiftKey) {
      e.preventDefault();
      sendMessage();
    }
  });

  // File Upload
  document.getElementById("plus-button").addEventListener("click", () => {
    const fileInput = document.createElement("input");
    fileInput.type = "file";
    fileInput.accept = "image/*";
    fileInput.click();
    fileInput.onchange = () => {
      const file = fileInput.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = e => {
        const img = document.createElement("img");
        img.src = e.target.result;
        img.style.maxWidth = "200px";
        img.style.cursor = "pointer";
        chatWindow.appendChild(img);

        img.addEventListener("click", () => {
          const modal = document.getElementById("image-modal");
          const modalImage = document.getElementById("modal-image");
          modalImage.src = img.src;
          modal.classList.remove("hidden");
        });
      };
      reader.readAsDataURL(file);
    };
  });

  // Close image modal
  document.querySelector(".close-button").addEventListener("click", () => {
    document.getElementById("image-modal").classList.add("hidden");
  });
});
